{%- extends "templateLoops/instantiate_muon_condition.j2" %}
{%- block instance_muon_condition %}
  {%- set objects = condition.objects %}
  {%- set bx = objects[0].bx %}
  {%- set cuts = condition.template %}
{{condition_name | lower}}_i: entity work.muon_conditions_v3
    generic map({{objects | count}} , {{ objects[0].operator | lower}},
        (X"{{cuts.Thresholds[0] | X04}}", X"{{cuts.Thresholds[1] | X04}}", X"{{cuts.Thresholds[2] | X04}}", X"{{cuts.Thresholds[3] | X04}}"),
        ({{cuts.EtaFullRange[0]}}, {{cuts.EtaFullRange[1]}}, {{cuts.EtaFullRange[2]}}, {{cuts.EtaFullRange[3]}}),
        (X"{{cuts.EtaW1UpperLimits[0] | X04}}", X"{{cuts.EtaW1UpperLimits[1] | X04}}", X"{{cuts.EtaW1UpperLimits[2] | X04}}", X"{{cuts.EtaW1UpperLimits[3] | X04}}"), (X"{{cuts.EtaW1LowerLimits[0] | X04}}", X"{{cuts.EtaW1LowerLimits[1] | X04}}", X"{{cuts.EtaW1LowerLimits[2] | X04}}", X"{{cuts.EtaW1LowerLimits[3] | X04}}"),
        ({{cuts.EtaW2Ignore[0]}}, {{cuts.EtaW2Ignore[1]}}, {{cuts.EtaW2Ignore[2]}}, {{cuts.EtaW2Ignore[3]}}),
        (X"{{cuts.EtaW2UpperLimits[0] | X04}}", X"{{cuts.EtaW2UpperLimits[1] | X04}}", X"{{cuts.EtaW2UpperLimits[2] | X04}}", X"{{cuts.EtaW2UpperLimits[3] | X04}}"), (X"{{cuts.EtaW2LowerLimits[0] | X04}}", X"{{cuts.EtaW2LowerLimits[1] | X04}}", X"{{cuts.EtaW2LowerLimits[2] | X04}}", X"{{cuts.EtaW2LowerLimits[3] | X04}}"),
        ({{cuts.PhiFullRange[0]}}, {{cuts.PhiFullRange[1]}}, {{cuts.PhiFullRange[2]}}, {{cuts.PhiFullRange[3]}}),
        (X"{{cuts.PhiW1UpperLimits[0] | X04}}", X"{{cuts.PhiW1UpperLimits[1] | X04}}", X"{{cuts.PhiW1UpperLimits[2] | X04}}", X"{{cuts.PhiW1UpperLimits[3] | X04}}"), (X"{{cuts.PhiW1LowerLimits[0] | X04}}", X"{{cuts.PhiW1LowerLimits[1] | X04}}", X"{{cuts.PhiW1LowerLimits[2] | X04}}", X"{{cuts.PhiW1LowerLimits[3] | X04}}"),
        ({{cuts.PhiW2Ignore[0]}}, {{cuts.PhiW2Ignore[1]}}, {{cuts.PhiW2Ignore[2]}}, {{cuts.PhiW2Ignore[3]}}),
        (X"{{cuts.PhiW2UpperLimits[0] | X04}}", X"{{cuts.PhiW2UpperLimits[1] | X04}}", X"{{cuts.PhiW2UpperLimits[2] | X04}}", X"{{cuts.PhiW2UpperLimits[3] | X04}}"), (X"{{cuts.PhiW2LowerLimits[0] | X04}}", X"{{cuts.PhiW2LowerLimits[1] | X04}}", X"{{cuts.PhiW2LowerLimits[2] | X04}}", X"{{cuts.PhiW2LowerLimits[3] | X04}}"),
        ("{{cuts.Charges[0]}}", "{{cuts.Charges[1]}}", "{{cuts.Charges[2]}}", "{{cuts.Charges[3]}}"),
        (X"{{cuts.QualityLUTs[0] | X04}}", X"{{cuts.QualityLUTs[1] | X04}}", X"{{cuts.QualityLUTs[2] | X04}}", X"{{cuts.QualityLUTs[3] | X04}}"),
        (X"{{cuts.IsolationLUTs[0] | X01}}", X"{{cuts.IsolationLUTs[1] | X01}}", X"{{cuts.IsolationLUTs[2] | X01}}", X"{{cuts.IsolationLUTs[3] | X01}}"),
        "{{cuts.ChargeCorrelation}}"
    )
    port map(lhc_clk, muon_bx_{{bx | lower}},
        ls_charcorr_double_bx_{{bx | lower}}_bx_{{bx | lower}}, os_charcorr_double_bx_{{bx | lower}}_bx_{{bx | lower}},
        ls_charcorr_triple_bx_{{bx | lower}}_bx_{{bx | lower}}, os_charcorr_triple_bx_{{bx | lower}}_bx_{{bx | lower}},
        ls_charcorr_quad_bx_{{bx | lower}}_bx_{{bx | lower}}, os_charcorr_quad_bx_{{bx | lower}}_bx_{{bx | lower}},
        {{condition_name | lower}});
{% endblock instance_muon_condition%}
{# eof #}
